{% extends '@FrontOffice/index.html.twig' %}

{% block title %}Côté Partenaire : {{ category.name }}{% endblock %}

{% block main %}
    <section class="app-section pagetitle">
        <h1>{{ category.title }}</h1>
    </section>

    {% if category.children | length > 0 %}
        <div class="app-grid two">
            {% for child in category.children %}
                <div class="grid-item">
                    <section class="app-section text {{ loop.index is even ? 'alt' : '' }}">
                        <h2>{{ child.title }}</h2>
                        <p>{{ child.description }}</p>
                        <p>
                            {% if loop.index is odd %}
                                <a href="{{ path('front_office_partenariat') }}" class="app-btn cta">
                                    Je deviens partenaire
                                </a>
                            {% else %}
                                <a href="{{ path('front_office_contact') }}" class="app-btn cta">Je prends contact</a>
                            {% endif %}
                        </p>
                    </section>

                    {% if child.services | length > 0 %}
                        <section class="app-section">
                            <div class="content">
                                <img src="{{ asset('uploads/services/category/' ~ child.cover) }}"
                                     alt="{{ child.name }}"/>
                                <h2>{{ child.name }}</h2>

                                {% for service in child.services %}
                                    <div class="sub">
                                        <img src="{{ asset('uploads/services/' ~ service.cover) }}"
                                             alt="{{ service.name }}"/>
                                        <a href="#"
                                           data-controller="popup--index"
                                           data-action="popup--index#open"
                                           data-popupid="popup-{{ service.id }}">
                                            {{ service.name | replace({' ': '<br/>'}) | raw }}
                                        </a>
                                        <div id="popup-{{ service.id }}" class="app-popup">
                                            <div class="popup-body">
                                                <div class="popup-header">
                                                    <h2>{{ service.name }}</h2>
                                                    <a href="#"
                                                       class="close"
                                                       data-controller="popup--index"
                                                       data-action="popup--index#close"
                                                       data-popupid="popup-{{ service.id }}">
                                                        <i class="fa-solid fa-circle-xmark"></i>
                                                    </a>
                                                </div>
                                                <div class="popup-content">
                                                    <img src="{{ asset('uploads/services/' ~ service.cover) }}"
                                                         alt="{{ service.name }}"/>
                                                    <p>{{ service.description }}</p>

                                                    <p class="app-grid two">
                                                        <a href="{{ path('front_office_contact') }}" class="app-btn">
                                                            Je me renseigne
                                                        </a>
                                                        <a href="{{ path('front_office_partenariat') }}"
                                                           class="app-btn cta">
                                                            Ça m'intéresse !
                                                        </a>
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </section>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    {% endif %}
{% endblock %}
